#  学习心得
## 什么是i2c                                  
### i2C是当今嵌入式应用中最常见的串行通信协议之一。  
### i2C总线
IIC 总线采用主从（Master-Slave）工作模式，总线上的设备分为主设备（Master）和从设备（Slave）。                                
主设备负责发起通信、产生时钟信号以及控制整个通信过程；从设备则响应主设备的请求进行数据传输。                                    
一个 IIC 总线系统中可以有多个从设备，但在同一时刻只能有一个主设备控制总线通信。                                    
## SDA
SDA 是 IIC 总线（Inter-Integrated Circuit 总线，也写作 I²C 总线）中的串行数据线（Serial Data Line）。                                    
在 IIC 总线通信过程中，SDA 线承担着传输数据的核心功能。                                  
SDA 线和 SCL 线（串行时钟线）紧密配合来完成 IIC 总线通信。SCL 线负责提供稳定的时钟脉冲信号，决定了数据传输的节奏和时序，                                              
SDA 线则依据 SCL 线的时钟节拍来进行相应的数据位电平变化以及应答信号的发送等操作。比如，在每一个时钟脉冲的高电平期间，                                    
SDA 线上的数据位电平需要保持稳定，以供接收方准确读取该位数据；而在时钟脉冲的低电平期间，SDA 线可以进行电平状态的切换，为下一位数据的传输做准备。                                    
## 时钟
硬件i2c   ，在cubemx中用的是标准模式（Standard Mode）：在这种模式下，SCL 时钟频率通常最高可达 100kHz（即每秒产生 100,000 个时钟脉冲），                                                 
适用于对传输速度要求不高、数据量相对较小且通信距离较短的简单应用场景，比如连接一些常规的低速传感器（如环境光传感器、简单的温度传感器等）                                                               
到主控芯片，进行环境参数的采集与传输。
## 学习IIC总线时序
### 主机向从机写数据时序
主机首先产生起始条件，将 SDA 线从高电平拉低（此时 SCL 为高电平）。                                                                                                                                  
接着主机发送从机地址，地址共 7 位（用于在总线上区分不同的从机设备），后面跟着 1 位读写位，写操作时该位为 0。                                                                                                                           
发送地址时按照先高位后低位顺序，每发送一位就在对应的 SCL 时钟周期内进行，并且在发送完 8 位（7 位地址 + 1 位读写位）后，                                                                                                                          
等待从机的应答信号（从机拉低 SDA 线表示应答）。                                                                                        
如果从机应答，主机就可以开始逐个字节地发送要写入从机的数据了，同样每发送完一个字节等待从机的应答信号，直到所有要写的数据都发送完毕。                                                  
最后主机产生停止条件，将 SDA 线从低电平拉高（此时 SCL 为高电平），结束本次写数据操作。                                              
### 主机从从机读数据时序
主机先发起起始条件，拉低 SDA 线（SCL 为高电平时）。
然后主机发送从机地址，7 位地址 + 1 位读写位（此时读写位为 1，表示读操作），发送完后等待从机应答。                                     
从机应答后，从机开始逐个字节地向主机发送数据，主机每接收完一个字节的数据后，需要向从机发送一个应答信号                                                                                                                      
（如果还想继续接收下一个字节数据就发送应答 ACK，不想接收了就发送非应答 NACK）。                                                                                                                            
当主机接收完所有需要的数据后，主机发送非应答信号给从机，然后产生停止条件（拉高 SDA 线，SCL 为高电平时），结束读数据操作。
                                                                   
                                                                                  
 ## 什么是i2c
SPI（Serial Peripheral Interface）总线是一种高速、全双工、同步的通信总线                                                                         
，常用于微控制器与各种外围设备（如传感器、显示屏、存储器等）之间的数据传输                                                                                                                                 
 ## CLK
 ### 时钟极性（CPOL）
 CPOL = 0：表示 SCLK 在空闲状态时为低电平，当开始进行数据传输时，SCLK 会在低电平和高电平之间周期性切换 ,                                                                                                                                                             
 产生相应的时钟脉冲来驱动数据传输。例如，在这种极性下，一个完整的时钟周期内先是低电平，随后上升沿到来开启数据采样                                                                                                                                                                                    
 （取决于 CPHA 设置），接着变为高电平，再到下降沿可进行数据改变等操作（同样取决于 CPHA）。                                                                            
 CPOL = 1：意味着 SCLK 在空闲状态时为高电平，数据传输期间在高电平和低电平之间变化。此时一个时钟周期开始是高电平，                                                                            
 然后下降沿可能用于数据采样（依据 CPHA），接着变为低电平，上升沿用于数据改变等情况。
 ### 时钟相位（CPHA）
 CPHA = 0：在这种模式下，数据在时钟信号 SCLK 的第一个边沿（上升沿或者下降沿，由 CPOL 决定，CPOL = 0 时是上升沿，CPOL = 1 时是下降沿）                                                                                                     
 进行采样，即从设备在这个边沿读取主设备通过 MOSI 发送过来的数据，主设备在这个边沿读取从设备通过 MISO 传来的数据；而数据的改变通常是在时钟的另一个                                          
 边沿，例如 CPOL = 0 时，数据在下降沿改变。CPHA = 1：此时数据在时钟信号 SCLK 的第二个边沿进行采样，相应地，数据的改变发生在第一个边沿。比如 CPO                                           
 L = 0 时，数据在下降沿采样，在上升沿改变。

CPOL 和 CPHA 这两个参数共同确定了 SPI 的四种工作模式（模式 0：CPOL = 0，CPHA = 0；模式 1：CPOL = 0，CPHA = 1；模式 2：CPOL = 1，CPHA = 0；                                                                                                                     
、模式 3：CPOL = 1，CPHA = 1），不同的从设备往往支持不同的工作模式，在进行 SPI 
## MOSI
MOSI 线主要用于实现数据从 SPI 总线的主设备传输到从设备。在 SPI 通信过程中，主设备将要发送的数据逐位通过 MOSI 信号线传送给与之通信的从设备，                                                                  
从设备则在 SPI 时钟信号（SCLK）的同步控制下，按照设定好的时钟极性（CPOL）和时钟相位（CPHA）所确定的规则，在相应的时钟边沿对 MOSI 线上的数                                                                              
据进行采样接收，从而完成数据从主到从的单向传输过程。
## MISO
MISO 线主要负责实现数据从 SPI 总线的从设备传输到主设备。在 SPI 通信过程中，从设备借助这条信号线，将自身需要反馈给主设备的数据逐位发送出去，                                                                             
主设备则会在 SPI 时钟信号（SCLK）的同步控制下，按照既定的时钟极性（CPOL）和时钟相位（CPHA）所确定的规则，在相应的时钟边沿对 MISO 线上的数据进行采                   
样接收，以此完成数据从从设备到主设备的单向传输，进而实现主从设备之间的双向数据交互，体现 SPI 总线全双工通信的特性。                                                                                                  
## DC
主要用于区分主设备（如微控制器）传送给从设备（比如液晶显示屏等 SPI 接口的外设）的信息是数据还是命令，以此来让从设备知晓该如何对接收的内容进行相应处理。                            
## RW
它一般用于区分对存储设备执行的是读取数据的操作还是写入数据的操作。
## RST
复位
## 一、SPI 总线时序概述
### 模式 0（CPOL = 0，CPHA = 0）
时钟信号（SCLK）：在空闲状态时，SCLK 为低电平。当开始数据传输，SCLK 会周期性地在低电平和高电平之间切换。上升沿用于从设备对 MOSI 线上主设备发送的数据                                                                                                                                     
进行采样，同时也是主设备对 MISO 线上从设备发送的数据进行采样的时刻；下降沿则是主设备改变 MOSI 线上要发送的下一位数据，以及从设备改变 MISO 线上要发送                                                                                                                                    
的下一位数据的时刻。
### 模式 1（CPOL = 0，CPHA = 1）
时钟信号（SCLK）：此时 SCLK 在空闲状态为高电平，数据在 SCLK 的下降沿进行采样，数据改变发生在上升沿。                                                                                                                        
数据传输：
主设备拉低 SS 线开启通信，在 SCLK 第一个下降沿前，主设备将 MSB 放在 MOSI 线上，下降沿时从设备采样 MOSI 数据、主设备采样 MISO 数据，之后在上升沿双方                                                                                                                                                                        
准备下一位数据，按此节奏完成 1 字节数据传输，按要求处理应答，结束通信时主设备拉高 SS 线。
### 模式 2（CPOL = 1，CPHA = 0）
时钟信号（SCLK）：此时 SCLK 在空闲状态为高电平，数据在 SCLK 的下降沿进行采样，数据改变发生在上升沿。                                                                               
数据传输：
主设备拉低 SS 线开启通信，在 SCLK 第一个下降沿前，主设备将 MSB 放在 MOSI 线上，下降沿时从设备采样 MOSI 数据、主设备采样 MISO 数据，之后在上升沿双方                                                                                                                   
准备下一位数据，按此节奏完成 1 字节数据传输，按要求处理应答，结束通信时主设备拉高 SS 线。
### 模式 3（CPOL = 1，CPHA = 1）
时钟信号（SCLK）：此时 SCLK 在空闲状态为高电平，数据在 SCLK 的下降沿进行采样，数据改变发生在上升沿。                                                                                         
数据传输：
主设备拉低 SS 线开启通信，在 SCLK 第一个下降沿前，主设备将 MSB 放在 MOSI 线上，下降沿时从设备采样 MOSI 数据、主设备采样 MISO 数据，之后在上升沿双方                                                                                                            
准备下一位数据，按此节奏完成 1 字节数据传输，按要求处理应答，结束通信时主设备拉高 SS 线。
### ![4f3a5a97bec4b947e1bfb4de30f73f0](https://github.com/user-attachments/assets/212d455e-b11c-4150-abbb-c7b9319cf68e)
![0740302a5e7a02f6bcb8b81055c9535](https://github.com/user-attachments/assets/397d83f8-750b-471e-9282-5670ba44b314)
